import{r as s,c as t,h as i}from"./p-f5b6b644.js";import"./p-1ba263c2.js";import"./p-19ec51eb.js";import"./p-811a61b7.js";import"./p-30f68cd2.js";import{a as e}from"./p-5444f5ad.js";import{R as o}from"./p-9d127c97.js";import{a}from"./p-01abdf5a.js";import{I as n}from"./p-283e4737.js";import{T as r}from"./p-2c007f74.js";const l=class{constructor(i){s(this,i),this.loading=!1,this.isDirty=!1,this.errors=[],this.store=t(this,"store")}componentWillLoad(){this.store.mapStateToProps(this,s=>({loading:e.getIsLoading(s),loginError:e.getLoginError(s),isLoggedIn:e.isLoggedIn(s)})),this.store.mapDispatchToProps(this,{loginAction:a})}loginErrorChanged(){if(this.loginError){let s=this.loginError;return"Unauthorized"===s&&(s="Could not log in. Please check your email/password."),r.error(s)}}loginChanged(){this.isLoggedIn&&(r.success("You have been logged in"),console.log("back to admin"),o.forward("/admin"))}validateDirtyInputs(){return!this.isDirty||this.validate()}validate(){const s=[];return this.email.value?n.validate(this.email.value)||s.push("Please enter a valid email address"):s.push("Please enter an email address"),this.password.value||s.push("Please enter your password"),this.errors=s,!s.length}login(){this.isDirty=!0,this.validate()&&this.loginAction(this.email.value,this.password.value)}render(){return[i("ion-content",null,i("app-header",null),i("section",{class:"section page-login"},i("div",{class:"login-form"}),i("h1",{class:"title text-center"},"Log In"),i("form",{onSubmit:s=>{s.preventDefault(),this.login()}},i("input",{type:"email",name:"email",value:"",class:"apt212-input block",placeholder:"Email",ref:s=>this.email=s,onChange:()=>this.validateDirtyInputs()}),i("input",{type:"password",name:"password",value:"",class:"apt212-input block",placeholder:"Password",ref:s=>this.password=s,onChange:()=>this.validateDirtyInputs()}),this.errors.length?i("div",{class:"errors"},this.errors.map(s=>i("div",null,s))):null,i("button",{type:"submit",class:"button-dark block login-submit",onClick:()=>this.login(),disabled:this.loading},"Log In",this.loading?i("ion-spinner",{name:"lines",color:"light"}):null))),i("app-footer",null))]}static get watchers(){return{loginError:["loginErrorChanged"],isLoggedIn:["loginChanged"]}}static get style(){return".page-login .login-submit{height:59px;font-size:16px}.page-login .errors{color:red;padding-bottom:12px}.page-login button ion-spinner{display:inline-block;vertical-align:middle;margin-left:1rem}"}};export{l as page_login};