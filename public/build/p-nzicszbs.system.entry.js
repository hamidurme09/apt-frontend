var __awaiter=this&&this.__awaiter||function(t,e,n,r){function s(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,i){function o(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r["throw"](t))}catch(t){i(t)}}function u(t){t.done?n(t.value):s(t.value).then(o,a)}u((r=r.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return u([t,e])}}function u(o){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,s&&(i=o[0]&2?s["return"]:o[0]?s["throw"]||((i=s["return"])&&i.call(s),0):s.next)&&!(i=i.call(s,o[1])).done)return i;if(s=0,i)o=[o[0]&2,i.value];switch(o[0]){case 0:case 1:i=o;break;case 4:n.label++;return{value:o[1],done:false};case 5:n.label++;s=o[1];o=[0];continue;case 7:o=n.ops.pop();n.trys.pop();continue;default:if(!(i=n.trys,i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){n=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){n.label=o[1];break}if(o[0]===6&&n.label<i[1]){n.label=i[1];i=o;break}if(i&&n.label<i[2]){n.label=i[2];n.ops.push(o);break}if(i[2])n.ops.pop();n.trys.pop();continue}o=e.call(t,n)}catch(t){o=[6,t];s=0}finally{r=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};System.register(["./p-c9001ae9.system.js","./p-69f5d316.system.js","./p-32fd337e.system.js","./p-57233c53.system.js","./p-a55517c8.system.js","./p-2a28951d.system.js","./p-94e7dad5.system.js","./p-905fd021.system.js","./p-86739eb0.system.js"],(function(t){"use strict";var e,n,r,s,i,o,a,u,c;return{setters:[function(t){e=t.r;n=t.c;r=t.h},function(){},function(){},function(t){s=t.a},function(t){i=t.R},function(t){o=t.T},function(t){a=t.A},function(t){u=t.s},function(t){c=t.A}],execute:function(){var l=t("page_admin_agents",function(){function t(t){e(this,t);this.isAdmin=false;this.isLoggedIn=false;this.pageSize=40;this.loaded=false;this.agents=[];this.resultCount=0;this.store=n(this,"store")}t.prototype.componentWillLoad=function(){this.store.mapStateToProps(this,(function(t){return{isLoggedIn:s.isLoggedIn(t),isAdmin:s.isAdmin(t),screenHeight:u.getHeight(t)}}));if(!this.isLoggedIn){i.forward("/login")}else{if(!this.isAdmin){i.forward("/")}}};t.prototype.componentDidLoad=function(){this.renderAgents()};t.prototype.componentDidRender=function(){var t=this;requestAnimationFrame((function(){if(t.agentsWrapper){t.agentsWrapper.style.maxHeight=t.getTableHeight()}}))};t.prototype.renderAgents=function(){return __awaiter(this,void 0,void 0,(function(){var t,e;return __generator(this,(function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,this.fetchAgents()];case 1:t=n.sent();this.agents=t;this.resultCount=t.total;this.loaded=true;return[3,3];case 2:e=n.sent();o.error(e.message);return[3,3];case 3:return[2]}}))}))};t.prototype.fetchAgents=function(){return __awaiter(this,void 0,void 0,(function(){var t,e;return __generator(this,(function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,a.getAgents()];case 1:t=n.sent();return[2,t];case 2:e=n.sent();return[2,o.error("Could not retrieve agents: "+e.message)];case 3:return[2]}}))}))};t.prototype.getTableHeight=function(){if(!this.agentsWrapper){return"500px"}return this.screenHeight-this.agentsWrapper.offsetTop-150+"px"};t.prototype.goTo=function(t){i.forward(t)};t.prototype.deleteAgent=function(t){return __awaiter(this,void 0,void 0,(function(){var e,n,r;return __generator(this,(function(s){switch(s.label){case 0:s.trys.push([0,3,,4]);return[4,c.confirm("Deleting this is a permanent action, are you sure you want to delete the agent?","Are you sure?")];case 1:if(!s.sent()){return[2]}return[4,a.deleteAgent(t)];case 2:e=s.sent();if(e.success){n=this.agents.filter((function(e){return e.id!==t}));this.agents=n;o.success("Agent has been deleted")}else{if(e.errors){o.error(e.errors.join("\n"));return[2]}if(e.message){o.error(e.message)}}return[3,4];case 3:r=s.sent();o.error(r.message);return[3,4];case 4:return[2]}}))}))};t.prototype.render=function(){var t=this;return[r("admin-header",null),r("ion-content",{class:"page-admin-agents"},r("h2",{class:"text-center"},"Agents"),r("section",{class:"section full"},r("div",{class:"listings-totals text-right"},r("button",{type:"button",class:"button-dark add-new","aria-label":"Add New",onClick:function(){return t.goTo("/admin/agent/")}},r("ion-icon",{name:"add-circle"}))),this.loaded?r("div",{class:"listings",style:{maxHeight:this.getTableHeight()},ref:function(e){return t.agentsWrapper=e}},r("table",{class:"data-table"},r("thead",null,r("tr",null,r("th",null,"Agent Name"),r("th",null,"Agent Email"),r("th",null,"Action"))),r("tbody",null,this.agents.map((function(e){return r("tr",null,r("td",null,e.name),r("td",null,e.email),r("td",null,r("button",{class:"button-dark",onClick:function(){return t.deleteAgent(e.id)}},r("ion-icon",{name:"trash"})),r("button",{class:"button-dark",onClick:function(){return t.goTo("/admin/agent/"+e.id)}},r("ion-icon",{name:"settings"}))))}))))):r("div",{class:"text-center"},r("ion-spinner",{name:"lines"}))))]};Object.defineProperty(t,"style",{get:function(){return".page-admin-agents .listings{margin-top:32px;padding-bottom:32px;max-height:500px;overflow:auto}.page-admin-agents .listings .data-table thead th{position:-webkit-sticky;position:sticky;top:0;background-color:#fff;white-space:nowrap;padding-right:8px;z-index:1}.page-admin-agents .listings .data-table thead th button{font-weight:inherit}.page-admin-agents .listings .data-table thead th button.desc ion-icon{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.page-admin-agents .listings .data-table thead th ion-icon{font-size:12px;margin-left:4px}.page-admin-agents .listings .data-table td{white-space:nowrap;border-left:1px solid #d8d8d8;background-color:#fff}.page-admin-agents button.button-dark.inactive{background-color:#888}.page-admin-agents button.button-dark.active-filter{margin-right:8px}.page-admin-agents .listings-totals{margin-top:-40px;padding-bottom:8px}.page-admin-agents .search{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.page-admin-agents .search .search-submit svg{width:1rem;height:1rem}.page-admin-agents .search button{height:48px}.page-admin-agents th{text-align:left;padding-left:8px;padding-bottom:10px}"},enumerable:true,configurable:true});return t}())}}}));