import{r as t,j as s,w as i,k as e,e as a,h as n,d as o,H as r,f as h,c as l}from"./p-f5b6b644.js";import"./p-1ba263c2.js";import{E as c}from"./p-19ec51eb.js";import"./p-811a61b7.js";import"./p-74149bb1.js";import{D as d}from"./p-82599b58.js";import{S as p}from"./p-980b9778.js";import{a as u,f as m,g}from"./p-08706a58.js";import{s as b}from"./p-8e0dcdf2.js";import{s as y,a as f}from"./p-3fe3eb5a.js";import{g as v}from"./p-15e55934.js";import{t as k}from"./p-7295e390.js";import{s as _}from"./p-4c12f224.js";import"./p-7be04cb4.js";import{i as C,j as w,k as L,l as S,m as M}from"./p-3d67b9a9.js";const x=class{constructor(i){t(this,i),this.thrPx=0,this.thrPc=0,this.didFire=!1,this.isBusy=!1,this.isLoading=!1,this.threshold="15%",this.disabled=!1,this.position="bottom",this.onScroll=()=>{const t=this.scrollEl;if(!t||!this.canStart())return 1;const s=this.el.offsetHeight;if(0===s)return 2;const i=t.scrollTop,e=t.offsetHeight,a=0!==this.thrPc?e*this.thrPc:this.thrPx;if(("bottom"===this.position?t.scrollHeight-s-i-a-e:i-s-a)<0){if(!this.didFire)return this.isLoading=!0,this.didFire=!0,this.ionInfinite.emit(),3}else this.didFire=!1;return 4},this.ionInfinite=s(this,"ionInfinite",7)}thresholdChanged(){const t=this.threshold;t.lastIndexOf("%")>-1?(this.thrPx=0,this.thrPc=parseFloat(t)/100):(this.thrPx=parseFloat(t),this.thrPc=0)}disabledChanged(){const t=this.disabled;t&&(this.isLoading=!1,this.isBusy=!1),this.enableScrollEvents(!t)}async connectedCallback(){const t=this.el.closest("ion-content");t?(this.scrollEl=await t.getScrollElement(),this.thresholdChanged(),this.disabledChanged(),"top"===this.position&&i(()=>{this.scrollEl&&(this.scrollEl.scrollTop=this.scrollEl.scrollHeight-this.scrollEl.clientHeight)})):console.error("<ion-infinite-scroll> must be used inside an <ion-content>")}disconnectedCallback(){this.enableScrollEvents(!1),this.scrollEl=void 0}async complete(){const t=this.scrollEl;if(this.isLoading&&t&&(this.isLoading=!1,"top"===this.position)){this.isBusy=!0;const s=t.scrollHeight-t.scrollTop;requestAnimationFrame(()=>{e(()=>{const e=t.scrollHeight-s;requestAnimationFrame(()=>{i(()=>{t.scrollTop=e,this.isBusy=!1})})})})}}canStart(){return!(this.disabled||this.isBusy||!this.scrollEl||this.isLoading)}enableScrollEvents(t){this.scrollEl&&(t?this.scrollEl.addEventListener("scroll",this.onScroll):this.scrollEl.removeEventListener("scroll",this.onScroll))}render(){const t=a(this);return n(r,{class:{[t]:!0,"infinite-scroll-loading":this.isLoading,"infinite-scroll-enabled":!this.disabled}})}get el(){return o(this)}static get watchers(){return{threshold:["thresholdChanged"],disabled:["disabledChanged"]}}static get style(){return"ion-infinite-scroll{display:none;width:100%}.infinite-scroll-enabled{display:block}"}},T=class{constructor(s){t(this,s)}componentDidLoad(){if(void 0===this.loadingSpinner){const t=a(this);this.loadingSpinner=h.get("infiniteLoadingSpinner",h.get("spinner","ios"===t?"lines":"crescent"))}}render(){const t=a(this);return n(r,{class:{[t]:!0,[`infinite-scroll-content-${t}`]:!0}},n("div",{class:"infinite-loading"},this.loadingSpinner&&n("div",{class:"infinite-loading-spinner"},n("ion-spinner",{name:this.loadingSpinner})),this.loadingText&&n("div",{class:"infinite-loading-text",innerHTML:b(this.loadingText)})))}static get style(){return"ion-infinite-scroll-content{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;min-height:84px;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.infinite-loading{margin-left:0;margin-right:0;margin-top:0;margin-bottom:32px;display:none;width:100%}.infinite-loading-text{margin-left:32px;margin-right:32px;margin-top:4px;margin-bottom:0}\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.infinite-loading-text{margin-left:unset;margin-right:unset;-webkit-margin-start:32px;margin-inline-start:32px;-webkit-margin-end:32px;margin-inline-end:32px}}.infinite-scroll-loading ion-infinite-scroll-content>.infinite-loading{display:block}.infinite-scroll-content-ios .infinite-loading-text{color:var(--ion-color-step-600,#666)}.infinite-scroll-content-ios .infinite-loading-spinner .spinner-crescent circle,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-lines-ios line,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-lines-small-ios line{stroke:var(--ion-color-step-600,#666)}.infinite-scroll-content-ios .infinite-loading-spinner .spinner-bubbles circle,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-circles circle,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-dots circle{fill:var(--ion-color-step-600,#666)}"}},j=class{constructor(s){t(this,s),this.items=[],this.neighborhoods=[],this.sortedItems=[...this.items],this.selectedListings=[],this.bedroomTypes=[],this.buildingTypes=[],this.sortMap=[{type:"webId",dir:"asc"},{type:"neighborhood",dir:"asc"},{type:"crossStreet",dir:"asc"},{type:"beds",dir:"asc"},{type:"baths",dir:"asc"},{type:"price",dir:"asc"},{type:"buildingType",dir:"asc"},{type:"availability",dir:"asc"}],this.neighborhoodMap={},this.store=l(this,"store")}componentWillLoad(){this.store.mapStateToProps(this,t=>({neighborhoods:k.getNeighborhoods(t),selectedListings:y.getSelectedListings(t),buildingTypes:k.getBuildingTypes(t),bedroomTypes:k.getBedroomTypes(t)})),this.store.mapDispatchToProps(this,{setSelectedListings:C})}componentDidLoad(){this.sortItems()}createNeighborhoodMap(){this.neighborhoods.forEach(t=>{this.neighborhoodMap[t.id]=t.name})}itemsUpdated(){this.sortItems()}sortMapUpdated(){this.sortItems()}sortItems(){const t=this.items.sort((t,s)=>{let i=0;return this.sortMap.forEach(e=>{0===i&&(i=this.sortItemsBy(t,s,e))}),i});this.sortedItems=[...t]}sortItemsBy(t,s,i){switch(i.type){case"webId":{if(t.id===s.id)return 0;const e=t.id>s.id?1:-1;return"asc"===i.dir?e:-1*e}case"neighborhood":return this.neighborhoods.length?t.neighborhood_ids[0]===s.neighborhood_ids[0]?0:this.neighborhoodMap[t.neighborhood_ids[0]].toLowerCase()>this.neighborhoodMap[s.neighborhood_ids[0]].toLowerCase()?"asc"===i.dir?1:-1:"asc"===i.dir?-1:1:0;case"crossStreet":return t.address.toLowerCase()===s.address.toLowerCase()?0:t.address.toLowerCase()>s.address.toLowerCase()?"asc"===i.dir?1:-1:"asc"===i.dir?-1:1;case"beds":return t.bedroom_type_id===s.bedroom_type_id?0:k.getBedroomTypeById(t.bedroom_type_id,this.bedroomTypes).rooms_count>k.getBedroomTypeById(s.bedroom_type_id,this.bedroomTypes).rooms_count?"asc"===i.dir?1:-1:"asc"===i.dir?-1:1;case"baths":return t.bathrooms===s.bathrooms?0:t.bathrooms>s.bathrooms?"asc"===i.dir?1:-1:"asc"===i.dir?-1:1;case"price":return t.rate===s.rate?0:t.rate>s.rate?"asc"===i.dir?1:-1:"asc"===i.dir?-1:1;case"buildingType":{if(t.building_type_id===s.building_type_id)return 0;const e=k.getBuildingTypeById(t.building_type_id,this.buildingTypes).name,a=k.getBuildingTypeById(s.building_type_id,this.buildingTypes).name;return e.toLowerCase()>a.toLowerCase()?"asc"===i.dir?1:-1:"asc"===i.dir?-1:1}case"availability":return t.available_date===s.available_date?0:new Date(t.available_date)>new Date(s.available_date)?"asc"===i.dir?1:-1:"asc"===i.dir?-1:1}}toggleSort(t){let s=[...this.sortMap],i=s.find(s=>s.type===t);s=s.filter(s=>s.type!==t),i.dir="asc"===i.dir?"desc":"asc",this.sortMap=[i,...s]}getButtonClass(t){let s={"button-reset":!0,"has-icon":!0};return s[this.sortMap.filter(s=>s.type===t)[0].dir]=!0,s}toggleAll(t){const s=this.el.querySelectorAll("apt212-checkbox.item-checkbox");s&&s.forEach(t.detail.checked?t=>t.check():t=>t.uncheck())}checkboxChecked(){const t=this.el.querySelectorAll(".item-checkbox"),s=[];t.forEach(t=>{s.push(new Promise(async s=>{const i=await t.isChecked();s({id:t.getAttribute("value"),checked:i})}))}),Promise.all(s).then(t=>{const s=t.filter(t=>t.checked).map(t=>parseInt(t.id));this.setSelectedListings(s)})}render(){const t=this.items.filter(t=>!this.selectedListings.includes(t.id));return n("div",{class:"listing-table-component"},n("table",{class:"listing-table"},n("thead",{class:"mobile-only"},n("tr",null,n("td",null,n("apt212-checkbox",{checked:!t.length,onCheckBoxChange:t=>this.toggleAll(t)})),n("td",null,n("button",{class:this.getButtonClass("webId"),"aria-label":"Sort by Web Id",onClick:()=>this.toggleSort("webId")},"Web Id ",n("ion-icon",{src:"/assets/images/icons/page_sort_arrow.svg"}))),n("td",null,n("button",{class:this.getButtonClass("neighborhood"),"aria-label":"Sort by Neighborhood",onClick:()=>this.toggleSort("neighborhood")},"Neighborhood ",n("ion-icon",{src:"/assets/images/icons/page_sort_arrow.svg"}))),n("td",null,n("button",{class:this.getButtonClass("crossStreet"),"aria-label":"Sort by Cross Street",onClick:()=>this.toggleSort("crossStreet")},"Cross Street ",n("ion-icon",{src:"/assets/images/icons/page_sort_arrow.svg"}))),n("td",null,n("button",{class:this.getButtonClass("beds"),"aria-label":"Sort by Beds",onClick:()=>this.toggleSort("beds")},"Beds ",n("ion-icon",{src:"/assets/images/icons/page_sort_arrow.svg"}))),n("td",null,n("button",{class:this.getButtonClass("baths"),"aria-label":"Sort by Bathroom number",onClick:()=>this.toggleSort("baths")},"Bath ",n("ion-icon",{src:"/assets/images/icons/page_sort_arrow.svg"}))),n("td",null,n("button",{class:this.getButtonClass("price"),"aria-label":"Sort by Price",onClick:()=>this.toggleSort("price")},"Price ",n("ion-icon",{src:"/assets/images/icons/page_sort_arrow.svg"}))),n("td",null,n("button",{class:this.getButtonClass("buildingType"),"aria-label":"Sort by Building Type",onClick:()=>this.toggleSort("buildingType")},"Building Type ",n("ion-icon",{src:"/assets/images/icons/page_sort_arrow.svg"}))),n("td",null,n("button",{class:this.getButtonClass("availability"),"aria-label":"Sort by Available Date",onClick:()=>this.toggleSort("availability")},"Available Date ",n("ion-icon",{src:"/assets/images/icons/page_sort_arrow.svg"}))),n("td",null))),n("tbody",null,this.sortedItems.map(t=>{const s=k.getBuildingTypeById(t.building_type_id,this.buildingTypes),i=k.getBedroomTypeById(t.bedroom_type_id,this.bedroomTypes);return n("tr",null,n("td",null,n("apt212-checkbox",{class:"item-checkbox",value:t.id,checked:this.selectedListings.includes(t.id),onCheckBoxChange:()=>this.checkboxChecked()})),n("td",{class:"desktop-only"},"#",t.id),n("td",{class:"desktop-only"},this.neighborhoodMap[t.neighborhood_ids[0]]),n("td",{class:"desktop-only"},t.street_address),n("td",{class:"desktop-only"},i.name),n("td",{class:"desktop-only"},t.bathrooms),n("td",{class:"desktop-only"},m(t.rate),"/month"),n("td",{class:"desktop-only"},s.name),n("td",{class:"desktop-only"},t.available_date),n("td",{class:"mobile-only"},n("table",{class:"mobile-inner"},n("tr",null,n("td",null,i.rooms_count>0?`${i.name} BD`:i.name," | ",t.bathrooms," BA"),n("td",null,this.neighborhoodMap[t.neighborhood_ids[0]])),n("tr",null,n("td",null,n("div",{class:"space"},s.name),n("div",{class:"space"},m(t.rate),"/month")),n("td",null,t.street_address)),n("tr",null,n("td",null,n("div",{class:"space no-wrap"},"Available: ",u(new Date(t.available_date),"m/d/y"))),n("td",null,n("div",{class:"space"},"Web ID: #",t.id))))),n("td",null,n("ion-button",{"aria-label":"View Listing",class:"reset view-listing",href:t.url_path},n("ion-icon",{src:"/assets/images/icons/list_page_arrow.svg",slot:"icon-only"}))))}))))}get el(){return o(this)}static get watchers(){return{neighborhoods:["createNeighborhoodMap"],items:["itemsUpdated"],sortMap:["sortMapUpdated"]}}static get style(){return".listing-table-component table{width:100%}.listing-table-component table thead{font-weight:700}.listing-table-component table thead.mobile-only{display:none}\@media (min-width:1200px){.listing-table-component table thead.mobile-only{display:table-header-group}}.listing-table-component table thead td{white-space:nowrap}.listing-table-component table tbody tr{border-top:1px solid #d8d8d8}.listing-table-component table tbody tr:hover{background-color:rgba(0,0,0,.03)}.listing-table-component table td{height:47px;padding:0 1rem}.listing-table-component table td.mobile-only{display:table-cell;font-size:12px;font-weight:700;height:auto;padding:1rem .25rem}\@media (min-width:1200px){.listing-table-component table td.mobile-only{display:none}}.listing-table-component table td.desktop-only{display:none}\@media (min-width:1200px){.listing-table-component table td.desktop-only{display:table-cell}}.listing-table-component table td:last-child{padding-left:0}.listing-table-component .button-reset{font-weight:700;font-family:proxima-nova,sans-serif}.listing-table-component .button-reset ion-icon{font-size:10px;margin-left:.75rem}.listing-table-component .button-reset.desc ion-icon{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.listing-table-component .item-checkbox{--apt212-checkbox-width:14px;--apt212-checkbox-height:14px}\@media (min-width:1200px){.listing-table-component .item-checkbox{--apt212-checkbox-width:10px;--apt212-checkbox-height:10px}}.listing-table-component .view-listing ion-icon{font-size:18px}.listing-table-component .mobile-only .space{padding-top:.5rem}.listing-table-component .mobile-only .space.top{padding-top:0}.listing-table-component .mobile-only table.mobile-inner{width:100%}.listing-table-component .mobile-only table.mobile-inner tr{border:0}.listing-table-component .mobile-only table.mobile-inner td{height:auto;padding:0}.listing-table-component .mobile-only table.mobile-inner td:first-child{width:125px;min-width:125px;padding:0 1rem 0 0}"}};!function(t,s,i,e){var a,n=arguments.length,o=n<3?s:null===e?e=Object.getOwnPropertyDescriptor(s,i):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,s,i,e);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(o=(n<3?a(o):n>3?a(s,i,o):a(s,i))||o);n>3&&o&&Object.defineProperty(s,i,o)}([d(100)],j.prototype,"checkboxChecked",null);const E=class{constructor(s){t(this,s),this.contentPadding=!1,this.neighborhoods=[],this.bedroomTypes=[],this.buildingTypes=[],this.item={},this.store=l(this,"store")}componentWillLoad(){this.store.mapStateToProps(this,t=>({neighborhoods:k.getNeighborhoods(t),bedroomTypes:k.getBedroomTypes(t),buildingTypes:k.getBuildingTypes(t),selectedListings:y.getSelectedListings(t)})),this.store.mapDispatchToProps(this,{setSelectedListing:w,setSearchListingHover:L})}getImageURL(){return console.log(this.item.images),this.item.images.length?this.item.images[0].medium:"/assets/images/placeholder/apt1.jpeg"}render(){let t=k.getNeighborhoodById(this.item.neighborhood_ids[0],this.neighborhoods);t||(t={name:"Unknown Neighborhood"});const s=k.getBedroomTypeById(this.item.bedroom_type_id,this.bedroomTypes),i=k.getBuildingTypeById(this.item.building_type_id,this.buildingTypes);let e;return e=0===this.item.images.length?[{src:this.getImageURL(),alt:`${t.name} furnished apartments`}]:this.item.images.map(s=>{const i=["furnished apartments","furnished rental","apartments"],e=i[Math.floor(Math.random()*i.length)];return{src:s.small,alt:`${t.name} ${e}`}}),[n("div",{class:"search-listing-card",onMouseEnter:()=>this.setSearchListingHover(this.item.map_marker_ids),onMouseLeave:()=>this.setSearchListingHover(!1)},n("maintain-ratio",{width:322,height:182},n("inline-gallery",{class:"gallery",images:e})),n("div",{class:{"listing-content-padding":this.contentPadding}},n("h4",{class:"listing-title"},n("ion-router-link",{href:this.item.url_path},this.item.cross_streets)),n("div",{class:"neighborhood"},n("ion-router-link",{href:this.item.url_path},t.name)),n("div",{class:"price"},n("ion-router-link",{href:this.item.url_path},m(this.item.rate)," /month")),n("div",{class:"available"},n("ion-router-link",{href:this.item.url_path},"Available ",u(new Date(this.item.available_date)))),n("div",{class:"bed-bath"},n("div",null,n("lazy-image",{src:"/assets/images/icons/bedroom.svg",class:"bedrooms",alt:"bedroom"})," ",v(s)),n("div",{class:"divider"},"|"),n("div",null,n("lazy-image",{src:"/assets/images/icons/bathroom.svg",class:"bathrooms",alt:"bathroom"})," ",this.item.bathrooms," Bathroom")),n("div",{class:"rating-amenities"},n("star-rating",{stars:5,size:16,rating:i.rating,readonly:!0}),n("div",{class:"amenities"},i.name),n("div",{class:"flex-spacer"}),n("apt212-checkbox",{checked:this.selectedListings.includes(this.item.id),onCheckBoxChange:t=>this.setSelectedListing(this.item.id,t.detail.checked)},n("span",{class:"sr-only"},"Select this listing")))))]}get el(){return o(this)}static get style(){return".search-listing-card{padding-bottom:15px}.search-listing-card .listing-title{margin-top:10px;margin-bottom:10px;height:16px;position:relative}\@media (min-width:1200px){.search-listing-card .listing-title{margin-bottom:0;height:28px}}.search-listing-card .listing-title ion-router-link{position:absolute;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-size:24px;text-transform:none}.search-listing-card .neighborhood{margin-bottom:10px}.search-listing-card .available,.search-listing-card .price{font-size:14px;padding-bottom:.5rem}.search-listing-card .bed-bath{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;font-size:12px;padding-bottom:.5rem}\@media (min-width:1200px){.search-listing-card .bed-bath{font-size:14px}}.search-listing-card .bed-bath>div{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.search-listing-card .bed-bath .divider{padding:0 1rem}\@media (min-width:1200px){.search-listing-card .bed-bath .divider{padding:0 .5rem}}.search-listing-card .bathrooms,.search-listing-card .bedrooms{width:.625rem;height:.625rem;margin-right:.25rem}\@media (min-width:1200px){.search-listing-card .bathrooms,.search-listing-card .bedrooms{width:1rem;height:1rem;margin-right:.5rem}}.search-listing-card .bedrooms{margin-top:-1px}.search-listing-card .bathrooms{margin-top:-3px}.search-listing-card .rating-amenities{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;font-size:12px}\@media (min-width:1200px){.search-listing-card .rating-amenities{font-size:14px}}.search-listing-card .rating-amenities .amenities{padding-left:.5rem;padding-bottom:4px}.search-listing-card .rating-amenities apt212-checkbox{--apt212-checkbox-width:18px;--apt212-checkbox-height:18px}.search-listing-card .listing-content-padding{padding:0 1rem 0 1rem}.search-listing-card .apt212-checkbox .checkbox{--apt212-checkbox-bg-color:#fff;--apt212-checkbox-border:1px solid #000}.search-listing-card .gallery{position:relative;height:100%}"}},D=class{constructor(i){t(this,i),this.autoInit=!1,this.neighborhoods=[],this.listings={},this.detail=null,this.location=[],this.listingHover=!1,this.searchFilters=[],this.mapMarkers=[],this.isMobile=!1,this.markers=[],this.loading=!1,this.mapId=`map-instance-${g(8)}`,this.map=null,this.mapRendered=!1,this.mapInitialized=!1,this.neighborhoodLayerMap={},this.lastMarkerSearchParams="",this.lastLocationIds="",this.mapInitialCenter=[-73.9830029,40.7825883],this.mapInitialZoom=11,this.mapInitialMobileZoom=10.3,this.mapZoomMax=17,this.mapZoomMin=11,this.mapLoaded=s(this,"mapLoaded",7),this.store=l(this,"store")}componentDidLoad(){this.store.mapStateToProps(this,t=>({neighborhoods:k.getNeighborhoods(t),location:f.getLocations(t),loading:y.getMapMarkersLoading(t),listingHover:y.getSearchListingHover(t),searchFilters:f.getAllFilters(t),mapMarkers:y.getMapMarkers(t),isMobile:_.getIsMobile(t)})),this.store.mapDispatchToProps(this,{getMapMarkers:S})}componentDidRender(){!this.mapRendered&&this.autoInit&&this.initializeMap()}async init(){this.mapInitialized||(this.mapInitialized=!0,this.initializeMap())}async resize(){this.mapInitialized&&this.map&&this.map.resize()}async addNeighborhood(t,s){if(!this.mapRendered)return;this.neighborhoodLayerMap[t]?this.neighborhoodLayerMap[t]++:this.neighborhoodLayerMap[t]=1;let i=`${t}-fill-${this.neighborhoodLayerMap[t]}`,e=`${t}-outline-${this.neighborhoodLayerMap[t]}`;await this.removeNeighborhood(t),this.map.addLayer({id:e,type:"line",source:{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:s}}},layout:{},paint:{"line-color":"#000","line-opacity":.7,"line-width":2}}),this.map.addLayer({id:i,type:"fill",source:{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:s}}},layout:{},paint:{"fill-color":"#000","fill-opacity":.2}})}async removeNeighborhood(t){if(!this.map)return;let s=`${t}-fill`,i=`${t}-outline`;this.neighborhoodLayerMap[t]&&(s+=`-${this.neighborhoodLayerMap[t]}`,i+=`-${this.neighborhoodLayerMap[t]}`),this.map.getLayer(s)&&this.map.removeLayer(s),this.map.getLayer(i)&&this.map.removeLayer(i)}async showDetails(t){if(!this.map)return;const s=this.mapMarkers.find(s=>s.id===parseInt(t));if(!s)return;this.closeDetails();const i=this.getZoomStep(this.map.getZoom());if(s.apartments_count>1&&i<5){const t=this.getMapZoomByStep(i+1);return void this.map.easeTo({center:[s.lng,s.lat],zoom:t})}const e=new mapboxgl.Popup({closeOnClick:!1,closeButton:!1,className:"map-listing-details",anchor:"top",maxWidth:"none",offset:[-50,30]}).setLngLat([s.lng,s.lat]).setHTML(`<map-listing-details marker-id="${s.id}" />`).addTo(this.map);this.detail=e}locationChanged(t,s){if(!this.map)return;const i=JSON.stringify(this.location.map(t=>t.id));if(i===this.lastLocationIds)return;this.lastLocationIds=i;const e=s.filter(s=>!t.includes(s)),a=t.filter(t=>!s.includes(t));e.forEach(t=>{const s=k.getNeighborhoodById(t,this.neighborhoods);s&&this.removeNeighborhood(s.slug)}),a.forEach(t=>{const s=k.getNeighborhoodById(t,this.neighborhoods);s&&s.perimeter_coordinates&&this.addNeighborhood(s.slug,s.perimeter_coordinates)});let n=!1,o=[[null,null],[null,null]];this.location.forEach(t=>{let s=k.getNeighborhoodById(t,this.neighborhoods);s.perimeter_coordinates.length&&(s.perimeter_coordinates[0].forEach(t=>{o[0][0]=null===o[0][0]?t[0]:Math.min(o[0][0],t[0]),o[0][1]=null===o[0][1]?t[1]:Math.min(o[0][1],t[1]),o[1][0]=null===o[1][0]?t[0]:Math.max(o[1][0],t[0]),o[1][1]=null===o[1][1]?t[1]:Math.max(o[1][1],t[1])}),n=!0)}),n?this.map.fitBounds(o,{maxZoom:15,linear:!0,padding:40}):this.map.easeTo({center:this.mapInitialCenter,zoom:this.isMobile?this.mapInitialMobileZoom:this.mapInitialZoom})}placeMarkers(t,s){if(!this.map)return;if(JSON.stringify(t)===JSON.stringify(s))return;this.removeAllMarkers(!0);let i=[[null,null],[null,null]],e=[];t.forEach(t=>{e.push(new mapboxgl.Popup({closeOnClick:!1,closeButton:!1,anchor:"center",className:`map-listing-marker marker-instance-${t.id}`,maxWidth:"none"}).setLngLat([t.lng,t.lat]).setHTML(`<map-listing-marker marker-id="${t.id}" />`)),i[0][0]=null===i[0][0]?t.lng:Math.min(i[0][0],t.lng),i[0][1]=null===i[0][1]?t.lat:Math.min(i[0][1],t.lat),i[1][0]=null===i[1][0]?t.lng:Math.max(i[1][0],t.lng),i[1][1]=null===i[1][1]?t.lat:Math.max(i[1][1],t.lat)}),e.forEach(t=>t.addTo(this.map)),this.markers=e}removeAllMarkers(t){t&&(this.detail&&(this.detail.remove(),this.detail=null),this.markers.forEach(t=>t.remove()),this.markers=[])}highlightMarker(t,s){if(t===s)return;this.closeDetails();const i=t=>{const s=this.el.querySelector(`.marker-instance-${t}`);s&&s.classList.add("hover")},e=t=>{const s=this.el.querySelector(`.marker-instance-${t}`);s&&s.classList.remove("hover")};!1!==t&&t.forEach(t=>i(t)),!1===t&&!1!==s&&s.forEach(t=>e(t))}closeDetails(){this.detail&&(this.detail.remove(),this.detail=null)}getMarkers(){if(this.map){const t={filters:this.searchFilters,bounds:this.map.getBounds(),zoom:this.getZoomStep(this.map.getZoom())},s=JSON.stringify(t);if(s===this.lastMarkerSearchParams)return;this.lastMarkerSearchParams=s,this.getMapMarkers(t)}}getZoomStep(t){const s=(this.mapZoomMax-this.mapZoomMin)/4;let i=this.mapZoomMin,e=1;for(;t>i;)e++,i+=s;return e}getMapZoomByStep(t){return this.mapZoomMin+(this.mapZoomMax-this.mapZoomMin)/4*(t-1)}onMapClick(){this.closeDetails()}initializeMap(){this.map&&(this.map.remove(),this.map=null),p.loadScript("mapbox","https://api.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.js").then(()=>{mapboxgl.accessToken=c.getInstance().get("MAPBOX_PUBLIC_TOKEN"),this.map=new mapboxgl.Map({container:this.mapId,style:"mapbox://styles/mapbox/streets-v11",center:this.mapInitialCenter,zoom:this.isMobile?this.mapInitialMobileZoom:this.mapInitialZoom,minZoom:10,maxZoom:17}),this.map.addControl(new mapboxgl.NavigationControl),this.map.on("load",()=>{this.mapRendered=!0,this.map.on("click",()=>this.onMapClick()),this.map.on("moveend",()=>this.getMarkers()),this.mapLoaded.emit()})})}render(){return n("div",{class:"search-map-component"},n("div",{id:this.mapId,class:"map-instance"}))}get el(){return o(this)}static get watchers(){return{location:["locationChanged"],mapMarkers:["placeMarkers"],listingHover:["highlightMarker"]}}static get style(){return"\@import url(\"https://api.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.css\");.search-map-component,.search-map-component .map-instance{width:100%;height:100%}.search-map-component .map-listing-marker{width:240px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-font-smoothing:antialiased}.search-map-component .map-listing-marker .mapboxgl-popup-content{-webkit-box-shadow:0 1px 3px 1px rgba(0,0,0,.24);box-shadow:0 1px 3px 1px rgba(0,0,0,.24);border-radius:6px;padding:.5rem .75rem}.search-map-component .map-listing-marker.hover,.search-map-component .map-listing-marker:hover{z-index:1}.search-map-component .map-listing-marker.hover .mapboxgl-popup-content{background:#cde3e0}.search-map-component .map-listing-details{max-width:320px;width:320px}.search-map-component .map-listing-details .mapboxgl-popup-tip{display:none}.search-map-component .map-listing-details .mapboxgl-popup-content{border-radius:3px;padding:0;background:transparent}"}};!function(t,s,i,e){var a,n=arguments.length,o=n<3?s:null===e?e=Object.getOwnPropertyDescriptor(s,i):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,s,i,e);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(o=(n<3?a(o):n>3?a(s,i,o):a(s,i))||o);n>3&&o&&Object.defineProperty(s,i,o)}([d(200)],D.prototype,"getMarkers",null);const B=class{constructor(s){t(this,s),this.store=l(this,"store")}componentWillLoad(){this.store.mapDispatchToProps(this,{clearFilters:M})}render(){return n("div",{class:"search-state-empty-component"},n("div",{class:"not-found text-center"},"No Results Found"),n("p",{class:"try-another text-center"},"Try another location, price range, etc",n("br",null),"or clear all filters"),n("button",{class:"button-reset",onClick:()=>this.clearFilters("all")},"Clear All Filters"))}static get style(){return".search-state-empty-component{width:100%;height:100%;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.search-state-empty-component .not-found{font-size:24px}.search-state-empty-component .try-another{font-size:16px}.search-state-empty-component button{border:1px solid #000;width:150px;height:40px}"}};export{x as ion_infinite_scroll,T as ion_infinite_scroll_content,j as listing_table,E as search_listing_card,D as search_map,B as search_state_empty};