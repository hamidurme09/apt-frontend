import{r as t,c as e,h as s,d as o}from"./p-f5b6b644.js";import"./p-1ba263c2.js";import"./p-19ec51eb.js";import"./p-811a61b7.js";import"./p-74149bb1.js";import{D as i}from"./p-82599b58.js";import"./p-08706a58.js";import{a as n,s as r}from"./p-3fe3eb5a.js";import"./p-7be04cb4.js";import{a}from"./p-3d67b9a9.js";import{n as l}from"./p-8f87c93e.js";const p=class{constructor(s){t(this,s),this.prefetching=!1,this.size="phone-only",this.view="map",this.searchResults=[],this.searchResultsCount=0,this.selectedListings=[],this._lastSearchFilters={},this.rendered=!1,this.headerObserver=null,this.footerOpen=!1,this.store=e(this,"store")}componentWillLoad(){this.prefetching||(this.store.mapStateToProps(this,t=>{const{screenSize:{size:e,width:s}}=t;return{size:e,width:s,neighborhoods:l.getNeighborhoods(t),location:n.getLocations(t),searchFilters:n.getAllFilters(t),loading:r.getLoading(t),searchResultsCount:r.getListingsCount(t),searchResults:r.getListings(t),selectedListings:r.getSelectedListings(t)}}),this.store.mapDispatchToProps(this,{performSearchAction:a}))}componentDidLoad(){if(this.prefetching)return;if(window.MutationObserver){this.headerObserver=new MutationObserver(()=>this.headerResized());const t={attributes:!1,childList:!0,subtree:!0},e=document.querySelector("app-header");this.headerObserver.observe(e,t)}new URLSearchParams(window.location.search).has("rooms")?this.performSearchAction({beds:["1"]}):this.performSearchAction(this.searchFilters)}componentDidRender(){if(this.prefetching)return;this.rendered=!0;const t=this.el.querySelector("search-map");t.init(),document.querySelector("ion-router").addEventListener("ionRouteDidChange",()=>{t.resize()})}viewChanged(){setTimeout(()=>{const t=document.createEvent("HTMLEvents");t.initEvent("resize",!0,!1),window.dispatchEvent(t)},25)}headerResized(){if(!this.rendered)return;const t=document.querySelector("app-header"),e=this.el.querySelector(".results-wrapper"),s=this.el.querySelector(".map-wrapper"),o=this.el.querySelector(".view-filters"),i=this.el.querySelector("search-map"),n=t?t.clientHeight:0,r=o?o.clientHeight:0;this.size.includes("desktop")?(e.style.maxHeight=null,s.style.height=null):(e.style.maxHeight=`calc(100vh - (${n}px + ${r}px))`,s.style.height=`calc(100vh - (${n}px + ${r}px))`),i.resize()}performSearch(){JSON.stringify(this.searchFilters)!==JSON.stringify(this._lastSearchFilters)&&(this._lastSearchFilters=Object.assign({},this.searchFilters),this.performSearchAction(this.searchFilters))}getViewClass(){let t={"page-search":!0};return t[this.view]=!0,this.searchResults.length||this.loading||(t["no-results"]=!0),this.loading&&(t.loading=!0),t}openSortBy(t){if(document.querySelector("apt212-popover.search-sortby"))return;const e=Object.assign(document.createElement("apt212-popover"),{component:"search-sortby-dropdown",target:t.currentTarget,styleOverride:{marginTop:"-1px",transform:"none"},animateSrc:"top center"});e.classList.add("search-sortby"),document.body.appendChild(e)}openSelectedMenu(t){if(!this.selectedListings.length)return;if(document.querySelector("apt212-popover.search-share"))return;const e=Object.assign(document.createElement("apt212-popover"),{component:"search-shareselected-dropdown",target:t.currentTarget,styleOverride:{marginTop:"-1px",transform:"none"},bindTo:{target:this.width>450?"bottom left":"bottom right",popover:this.width>450?"top left":"top right"},animateSrc:"top center"});e.classList.add("search-share"),document.body.appendChild(e)}async infiniteScroll(t){await this.performSearchAction(this.searchFilters,this.searchResults.length),t.target.complete()}render(){if(this.prefetching)return null;let t=[];return this.searchResults.forEach(e=>{t.push(s("div",{class:"card-wrapper"},s("search-listing-card",{item:e,contentPadding:!0})))}),[s("app-header",{"hide-search-button":!0}),s("ion-content",{class:this.getViewClass()},s("section",{class:"section main"},s("div",{class:"search-wrapper"},s("div",{class:"search-results"},s("div",{class:"view-filters",slot:"view-filters"},s("button",{"aria-label":"Map View",class:{"view-nav":!0,active:"map"===this.view},onClick:()=>{this.view="map"}},s("svg",{width:"22px",height:"17px",viewBox:"0 0 22 17",version:"1.1"},s("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},s("path",{d:"M6.44693757,1.03946443 C6.7521634,0.92314383 7,1.07269915 7,1.3732543 L7,13.3434138 C7,13.6446884 6.75375471,13.9820849 6.44693757,14.099125 L1.55385803,15.9601514 C1.24783655,16.0771933 1,15.9276399 1,15.6263612 L1,3.65694337 C1,3.35566874 1.24624523,3.01827223 1.55385803,2.90123215 L6.44693757,1.03946443 Z M20.4461419,1.03984861 C20.7521634,0.922806667 21,1.07236016 21,1.37363852 L21,13.3430576 C21,13.6443323 20.7537547,13.9817289 20.4461419,14.0987689 L15.5530624,15.9605356 C15.2478366,16.0768562 15,15.9273008 15,15.6267451 L15,3.65658431 C15,3.35530965 15.2462453,3.0179131 15.5530624,2.90087301 L20.4461419,1.03984861 Z M8.55378464,1.03984861 C8.24780374,0.922806667 8,1.07236016 8,1.37363852 L8,13.3430576 C8,13.6443323 8.24621264,13.9817289 8.55378464,14.0987689 L13.4462154,15.9605356 C13.7521963,16.0768562 14,15.9273008 14,15.6267451 L14,3.65658431 C14,3.35530965 13.7537874,3.0179131 13.4462154,2.90087301 L8.55378464,1.03984861 Z",id:"Fill-1",fill:"#000000"})))),s("button",{"aria-label":"Grid View",class:{"view-nav":!0,active:"grid"===this.view},onClick:()=>{this.view="grid"}},s("svg",{width:"18px",height:"17px",viewBox:"0 0 18 17",version:"1.1"},s("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},s("g",{transform:"translate(1.000000, 0.000000)",fill:"#000000"},s("polygon",{points:"0 3.55555556 3.55555556 3.55555556 3.55555556 0 0 0"}),s("polygon",{points:"6.22266667 3.55555556 9.77822222 3.55555556 9.77822222 0 6.22266667 0"}),s("polygon",{points:"12.4444444 3.55555556 16 3.55555556 16 0 12.4444444 0"}),s("polygon",{points:"0 16 3.55555556 16 3.55555556 12.4444444 0 12.4444444"}),s("polygon",{points:"6.22222222 16 9.77777778 16 9.77777778 12.4444444 6.22222222 12.4444444"}),s("polygon",{points:"12.4444444 16 16 16 16 12.4444444 12.4444444 12.4444444"}),s("polygon",{points:"12.4444444 9.77777778 16 9.77777778 16 6.22222222 12.4444444 6.22222222"}),s("polygon",{points:"6.22222222 9.77777778 9.77777778 9.77777778 9.77777778 6.22222222 6.22222222 6.22222222"}),s("polygon",{points:"0 9.77777778 3.55555556 9.77777778 3.55555556 6.22222222 0 6.22222222"}))))),s("button",{"aria-label":"List View",class:{"view-nav":!0,active:"list"===this.view},onClick:()=>{this.view="list"}},s("svg",{width:"22px",height:"17px",viewBox:"0 0 22 17",version:"1.1"},s("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},s("g",{transform:"translate(2.000000, 0.000000)",fill:"#000000"},s("polygon",{points:"0 3.55555556 3.55555556 3.55555556 3.55555556 0 0 0"}),s("polygon",{points:"6.22266667 3.55555556 17.2226667 3.55555556 17.2226667 0 6.22266667 0"}),s("polygon",{points:"0 16 3.55555556 16 3.55555556 12.4444444 0 12.4444444"}),s("polygon",{points:"6.22222222 16 17.2222222 16 17.2222222 12.4444444 6.22222222 12.4444444"}),s("polygon",{points:"6.22222222 9.77777778 17.2222222 9.77777778 17.2222222 6.22222222 6.22222222 6.22222222"}),s("polygon",{points:"0 9.77777778 3.55555556 9.77777778 3.55555556 6.22222222 0 6.22222222"}))))),s("div",{class:"results-count"},this.searchResultsCount," Results"),s("button",{class:"button-reset has-icon dropdown",onClick:t=>this.openSortBy(t)},"Sort By",s("ion-icon",{mode:"md",name:"md-arrow-dropdown"})),s("button",{class:"button-reset has-icon dropdown",onClick:t=>this.openSelectedMenu(t)},this.selectedListings.length," Selected",this.selectedListings.length?s("ion-icon",{mode:"md",name:"md-arrow-dropdown"}):null)),s("div",{class:"results-wrapper"},s("div",{class:"results-grid"},t),s("div",{class:"results-list"},s("listing-table",{items:this.searchResults})),s("div",{class:"empty-state"},s("search-state-empty",null)),s("div",{class:"loading-state"},s("ion-spinner",{name:"lines"}),"Search in progress...")),s("ion-infinite-scroll",{threshold:"100px",onIonInfinite:t=>this.infiniteScroll(t)},s("ion-infinite-scroll-content",{"loading-spinner":"lines"}))),s("div",{class:{"search-map":!0,"mobile-map":"map"===this.view}},s("div",{class:"map-wrapper"},s("search-map",{onMapLoaded:t=>{t.target.resize()}}))))),s("div",{class:{"search-footer":!0,"footer-open":this.footerOpen,"footer-closed":!this.footerOpen}},s("div",{class:"section toggle-footer-wrapper"},s("button",{class:"button-reset toggle-footer","aria-label":"Open/Close Footer",onClick:()=>this.footerOpen=!this.footerOpen},s("span",{class:"closed"},"Open Footer"),s("ion-icon",{mode:"md",name:"md-arrow-dropup",class:"closed"}),s("span",{class:"open"},"Close Footer"),s("ion-icon",{mode:"md",name:"md-arrow-dropdown",class:"open"}))),s("div",{class:"footer-wrapper"},s("app-footer",{"no-margin":!0}))))]}get el(){return o(this)}static get watchers(){return{view:["viewChanged"],width:["headerResized"],searchFilters:["performSearch"]}}static get style(){return".page-search .section.main{padding:0}\@media (min-width:1200px){.page-search .section.main{padding:0 0 0 1.5rem}}\@media (min-width:1200px){.page-search .search-wrapper{display:-ms-flexbox;display:flex}}.page-search .search-wrapper .search-results{position:relative;width:100%}.page-search .search-wrapper .search-results .card-wrapper{border:1px solid #cbcbcb}.page-search .search-wrapper .search-results .view-filters{display:-ms-flexbox;display:flex;position:-webkit-sticky;position:sticky;top:0;-ms-flex-align:center;align-items:center;background:#fff;z-index:1;height:48px;width:100%;-webkit-box-shadow:inset 0 -1px 0 0 #e5e5e5,inset 0 1px 0 0 #e5e5e5;box-shadow:inset 0 -1px 0 0 #e5e5e5,inset 0 1px 0 0 #e5e5e5;overflow:hidden;z-index:2}.page-search .search-wrapper .search-results .view-filters button.view-nav{background:transparent;height:100%;width:48px;margin-top:-1px;outline:0}.page-search .search-wrapper .search-results .view-filters button.view-nav svg{width:20px}.page-search .search-wrapper .search-results .view-filters button.view-nav.active{background:#000}.page-search .search-wrapper .search-results .view-filters button.view-nav.active svg *{fill:#fff}.page-search .search-wrapper .search-results .view-filters label{display:none}\@media (min-width:1200px){.page-search .search-wrapper .search-results .view-filters label{display:inline-block;padding-left:1rem}}.page-search .search-wrapper .search-results .view-filters select{height:32px;border:1px solid #dfdfdf;font-size:12px;margin-left:1rem}.page-search .search-wrapper .search-results .view-filters .results-count{display:none;padding-left:1rem}\@media (min-width:1200px){.page-search .search-wrapper .search-results .view-filters .results-count{display:inline-block}}.page-search .search-wrapper .search-results .view-filters button.dropdown{margin-left:2rem;font-size:14px;height:48px}.page-search .search-wrapper .search-results .view-filters button.dropdown ion-icon{margin-left:.25rem}\@media (min-width:1200px){.page-search .search-wrapper .search-results .view-filters button.dropdown{font-size:16px}.page-search .search-wrapper .search-results .view-filters button.dropdown ion-icon{margin-left:.5rem}}\@media (min-width:1200px){.page-search .search-wrapper .search-results{width:50%}}\@media (max-width:1199px){.page-search .search-wrapper .search-results{max-height:calc(100vh - 75px - 56px)}}.page-search .search-wrapper .search-map{position:relative;width:100%}\@media (min-width:1200px){.page-search .search-wrapper .search-map{width:50%;padding-top:0}}.page-search .search-wrapper .search-map .map-wrapper{display:block;position:-webkit-sticky;position:sticky;overflow:hidden;top:0;width:100%;height:calc(100vh - (56px + 48px + 75px))}\@media (min-width:1200px){.page-search .search-wrapper .search-map .map-wrapper{width:100%;height:calc(100vh - (56px + 112px))}}\@media (max-width:1199px){.page-search .search-wrapper .results-wrapper{max-height:calc(100vh - (56px + 48px + 75px));overflow:hidden;overflow-y:scroll}.page-search .search-wrapper .mobile-map{position:fixed;width:100%}}.page-search .search-wrapper .results-list{padding:0 1.5rem 1rem 0;display:none}.page-search .empty-state,.page-search .loading-state{display:none;height:calc(100vh - (56px + 112px + 48px))}\@media (min-width:1200px){.page-search .empty-state,.page-search .loading-state{height:calc(100vh - (56px + 112px + 48px))}}.page-search.no-results .empty-state{display:block}.page-search.no-results .results-wrapper>div:not(.empty-state),.page-search.no-results .search-map{display:none}\@media (min-width:1200px){.page-search.no-results .search-map{display:block}}.page-search.loading .loading-state{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;justify-items:center;-ms-flex-pack:center;justify-content:center;text-align:center}.page-search.loading .results-wrapper>div:not(.loading-state),.page-search.loading .search-map{display:none}\@media (min-width:1200px){.page-search.loading .search-map{display:block}}.page-search.grid .search-results{width:100%}.page-search.grid .search-results .results-grid{display:grid;grid-template-columns:1fr 1fr;gap:24px;padding:1.5rem 2rem 1.5rem}\@media (max-width:767px){.page-search.grid .search-results .results-grid{grid-template-columns:1fr}}\@media (min-width:768px){.page-search.grid .search-results .results-grid{grid-template-columns:1fr 1fr}}\@media (min-width:900px){.page-search.grid .search-results .results-grid{grid-template-columns:1fr 1fr 1fr}}\@media (min-width:1200px){.page-search.grid .search-results .results-grid{padding:1.5rem 1.5rem 1rem 0;grid-template-columns:1fr 1fr 1fr 1fr}}.page-search.grid .search-map,.page-search.grid .search-results .results-list{display:none}.page-search.list .search-results{width:100%}.page-search.list .search-results .results-grid{display:none}.page-search.list .search-results .results-list{display:block;padding:1.5rem 0 1.5rem 0}\@media (min-width:1200px){.page-search.list .search-results .results-list{padding:1.5rem 1.5rem 1rem 0}}.page-search.list .search-map{display:none}\@media (min-width:1200px){.page-search.map .search-results{padding-top:0}}.page-search.map .search-results .results-grid{display:none}\@media (min-width:1200px){.page-search.map .search-results .results-grid{display:grid;grid-template-columns:1fr 1fr;gap:24px;padding:1.5rem 1.5rem 1rem 0}}.page-search.map ion-infinite-scroll{display:none}\@media (min-width:1200px){.page-search.map ion-infinite-scroll{display:block}}.page-search .search-footer{display:none;z-index:2}\@media (min-width:1200px){.page-search .search-footer{display:block;position:fixed;bottom:0;width:100%}.page-search .search-footer .toggle-footer-wrapper{position:relative}.page-search .search-footer .toggle-footer{position:absolute;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;top:-48px;right:52px;width:190px;height:48px;background:rgba(0,0,0,.8);color:#fff;text-transform:uppercase;display:-ms-inline-flexbox;display:inline-flex;font-size:12px;font-weight:700;padding:0 1rem}.page-search .search-footer .toggle-footer span{text-align:left;-ms-flex-positive:1;flex-grow:1}.page-search .search-footer .footer-wrapper{max-height:0;-webkit-transition:all .2s ease-in;transition:all .2s ease-in}}.page-search .search-footer.footer-open .closed{display:none}\@media (min-width:1200px){.page-search .search-footer.footer-open .footer-wrapper{max-height:620px}}.page-search .search-footer.footer-closed .open{display:none}"}};!function(t,e,s,o){var i,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(n<3?i(r):n>3?i(e,s,r):i(e,s))||r);n>3&&r&&Object.defineProperty(e,s,r)}([i(250)],p.prototype,"performSearch",null);export{p as page_search};